{% extends 'base/base.html' %}

{% block content %}
<style>
    #header {
        text-align: center;
    }

    #main {
        border: 1px solid red;
        display: flex;
        /* flex-direction: column; */
        text-align: center;
        width: 100%;
    }

    #row {
        width: 1200px;
        display: flex;
        flex-direction: row;
        margin: 40px auto;
        justify-content: space-between;
    }

    #wordwrap {
        display: flex;
        flex-direction: row;
        margin: 0 auto;
    }

    #westwrap {
        display: flex;
        flex-direction: column;
    }

    #wordcloud {
        border: 1px solid black;
        width: 800px;
        height: 300px;
    }

    #weather {
        border: 1px solid black;
        width: 200px;
        height: 150px;
    }

    #stock {
        border: 1px solid black;
        width: 200px;
        height: 150px;
    }

    #intro {
        border: 1px solid black;
        width: 100px;
        height: 100px;
        margin: 0 auto;
    }
    #index{
        width: 100%;
        height: 1080px;
    }
    #container {
        width: 1200px;
        height: 500px;
        margin: 0 auto;
        margin-top: 40px;
        padding: 0;
    }

    #sectionwrap{
        width: 580px;
        height: 350px;
        display: flex;
        flex-direction: row;
        overflow-x: auto;
    }
    .section{
        width:580px;
        height: 350px;
        border: 1px solid black;
        flex: 0 0 auto;
    }
    #menuwrap{
        display: flex;
        flex-direction: row;
    }
    .sectionid{
        width: 116px;
        height: 60px;
        border: 1px solid black;
    }
    </style>
<script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"></script>
<script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-tag-cloud.min.js"></script>
<script type='text/javascript' src='https://www.weatherapi.com/weather/widget.ashx?loc=1377353&wid=4&tu=1&div=weatherapi-weather-widget-4' async></script>

<div id="index">
    <div id="container" style="border: 1px solid black; border-radius: 20px;"></div>
    <div id="row">
        <div style="width:580px;" id="weatherapi-weather-widget-4"></div>
        <div id="sectioncont">
            <div id="sectionwrap">
                <div id="section1" class="section"></div>
                <div id="section2" class="section"></div>
                <div id="section3" class="section"></div>
                <div id="section4" class="section"></div>
                <div id="section5" class="section"></div>
            </div>
            <div id="menuwrap">
                <div class="sectionid">정치</div>
                <div class="sectionid">경제</div>
                <div class="sectionid">사회</div>
                <div class="sectionid">세계</div>
                <div class="sectionid">IT</div>
            </div>
        </div>
    </div>
</div>

{% for keyword in keywords %}
<div>
    <div>{{keyword.keyword}}</div>
    <div>{{keyword.count}}</div>
</div>
{% endfor %}

<script>
    anychart.onDocumentReady(function () {
        var sectionData = [
            { x: "정치섹션", value: 80 },
            { x: "includes", value: 56 },
            { x: "lists", value: 44 },
            { x: "meaning", value: 40 },
            { x: "useful", value: 36 },
            { x: "different", value: 32 },
            { x: "grammar", value: 28 },
            { x: "teaching", value: 24 },
            { x: "example", value: 20 },
            { x: "thing", value: 12 },
            { x: "riding", value: 80 },
            { x: "increse", value: 56 },
            { x: "titles", value: 44 },
            { x: "understand", value: 40 },
            { x: "useless", value: 36 },
            { x: "difficult", value: 32 },
            { x: "verb", value: 28 },
            { x: "studing", value: 24 },
            { x: "test", value: 20 },
            { x: "one", value: 12 },
        ];
        for(var i=1; i<6; i++){
            var sectionChart = anychart.tagCloud(sectionData);
            sectionChart.container("section"+i);
            sectionChart.draw();
        }
        // create data   
        var data = [
            { x: "비상경보", value: 80 },
            { x: "includes", value: 56 },
            { x: "lists", value: 44 },
            { x: "meaning", value: 40 },
            { x: "useful", value: 36 },
            { x: "different", value: 32 },
            { x: "grammar", value: 28 },
            { x: "teaching", value: 24 },
            { x: "example", value: 20 },
            { x: "thing", value: 12 },
            { x: "riding", value: 80 },
            { x: "increse", value: 56 },
            { x: "titles", value: 44 },
            { x: "understand", value: 40 },
            { x: "useless", value: 36 },
            { x: "difficult", value: 32 },
            { x: "verb", value: 28 },
            { x: "studing", value: 24 },
            { x: "test", value: 20 },
            { x: "one", value: 12 },
        ];

        var test = []
        let posts = JSON.parse("{{ keywords_json | escapejs }}")
        console.log(posts)

        // create a chart and set the data
        var chart = anychart.tagCloud(posts);
        var sectionChart = anychart.tagCloud(sectionData);

        // set the container id
        chart.container("container");
        
        
        // initiate drawing the chart
        chart.draw();
        

        // configure angles
        //chart.angles([0, 270, 90]);

        // set the mode of the tag cloud
        // chart.mode("spiral"); // or "rect"

        // add an event listener to open a url on click
        chart.listen("pointClick", function (e) {
            var url = "/search/?search=" + e.point.get("x")+"&press=&section=";
            window.open(url, "_blank");
        });

    });
</script>
{% endblock %}